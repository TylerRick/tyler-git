#!/bin/sh

# usage: $0 <orig-sha>

# Amends the tip commit, copying the committer (TODO: and other)
# metadata from $rev.
# This can be used during a rebase, for example, since a rebase will
# by default set the committer name and date to you and now. It provides
# --committer-date-is-author-date but no way to keep committer date how it was in the original
# commit. See git-rebase-set-commit-date-to-author-date for my solution which calls this after each
# pick command during a rebase.

# See also: git-commit-cp, git-commit-modify

#====================================================================================================
rev=$1

GIT_COMMITTER_NAME="$(git show -s --format='%cn'  $rev)" \
GIT_COMMITTER_EMAIL="$(git show -s --format='%ce'  $rev)" \
GIT_COMMITTER_DATE="$(git show -s --format='%cI'  $rev)" \
git commit --allow-empty --amend --no-edit --no-verify

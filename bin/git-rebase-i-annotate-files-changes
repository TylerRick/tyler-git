#!/bin/bash
# See notes in git-rebase-i-annotate-files-changes.txt

set -e

if [ -z "$1" ]; then
  echo >&2 "Usage: $(basename $0) <onto_commit>"
  echo >&2 "Rebases onto <onto_commit>."
  echo >&2 "Generates a file containing the list of commits that will be applied onto <onto_commit> along with information that will be helpful in determining which commits can be safely reordered without any chance of a merge conflict."
  exit 1
fi

export onto=$1; shift

cd $(dirname "$(git rev-parse --git-dir)")
# TODO: add an option to use --squash instead of --fixup
#git commit --fixup $onto
#git rebase -i --autosquash $onto^

export GIT_SEQUENCE_EDITOR="$0-editor_wrapper"
git-commit-fixup-rebase $onto

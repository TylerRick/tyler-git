#!/usr/bin/env ruby

require 'rubygems' 
require 'git'      # requires my local changes

git = Git.open('.')

#puts git.status.untracked.map{|filename, o| filename}[0..10]

if ARGV.grep('-h').any? || ARGV.grep('--help').any?
  puts "Usage: git-ls-files-by-status [-1|--one-line] (--new|--modified|--deleted|--untracked)* | (-N|-M|-D|-U)*"
  exit
end

if ARGV.grep('-1').any? || ARGV.grep('--one-line').any?
  @one_line = true
end

if @one_line
  if ARGV.grep('-N').any? || ARGV.grep('--new').any?
    puts git.status.new.join(' ')
  end
  if ARGV.grep('-M').any? || ARGV.grep('--modified').any?
    puts git.status.modified.join(' ')
  end
  if ARGV.grep('-D').any? || ARGV.grep('--deleted').any?
    puts git.status.deleted.join(' ')
  end
  if ARGV.grep('-U').any? || ARGV.grep('--untracked').any?
    puts git.status.untracked.join(' ')
  end
else
  if ARGV.grep('-N').any? || ARGV.grep('--new').any?
    puts git.status.new
  end
  if ARGV.grep('-M').any? || ARGV.grep('--modified').any?
    puts git.status.modified
  end
  if ARGV.grep('-D').any? || ARGV.grep('--deleted').any?
    puts git.status.deleted
  end
  if ARGV.grep('-U').any? || ARGV.grep('--untracked').any?
    puts git.status.untracked
  end
end
